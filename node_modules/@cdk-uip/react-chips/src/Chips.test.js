import React from "react";
import TestUtils from "react-dom/test-utils";
import {
  ChipSet,
  Chip,
  ChipText,
  ChipLeadingIcon,
  ChipDeleteIcon,
  ChipCheckmark
} from ".";
import renderer from "react-test-renderer";

it("renders action chips", () => {
  expect(
    renderer.create(
      <ChipSet>
        <Chip>
          <ChipLeadingIcon>wb_sunny</ChipLeadingIcon>
          <ChipText>Chip One</ChipText>
        </Chip>
        <Chip selected>
          <ChipLeadingIcon>face</ChipLeadingIcon>
          <ChipText>Chip Two</ChipText>
        </Chip>
      </ChipSet>
    )
  ).toMatchSnapshot();
});

it("renders choice chips", () => {
  expect(
    renderer.create(
      <ChipSet choice>
        <Chip>
          <ChipText>Chip One</ChipText>
        </Chip>
        <Chip selected>
          <ChipText>Chip Two</ChipText>
        </Chip>
      </ChipSet>
    )
  ).toMatchSnapshot();
});

it("renders filter chips", () => {
  expect(
    renderer.create(
      <ChipSet filter>
        <Chip>
          <ChipCheckmark />
          <ChipText>Chip One</ChipText>
        </Chip>
        <Chip>
          <ChipLeadingIcon>face</ChipLeadingIcon>
          <ChipCheckmark />
          <ChipText>Chip Two</ChipText>
        </Chip>
        <Chip selected>
          <ChipLeadingIcon hidden>face</ChipLeadingIcon>
          <ChipCheckmark />
          <ChipText>Chip Three</ChipText>
        </Chip>
      </ChipSet>
    )
  ).toMatchSnapshot();
});

it("renders input chips", () => {
  const onDelete = jest.fn();
  expect(
    renderer.create(
      <ChipSet input>
        <Chip>
          <ChipLeadingIcon>face</ChipLeadingIcon>
          <ChipText>Chip One</ChipText>
          <ChipDeleteIcon onClick={onDelete} />
        </Chip>
        <Chip selected>
          <ChipText>Chip Two</ChipText>
          <ChipLeadingIcon onClick={onDelete}>face</ChipLeadingIcon>
        </Chip>
      </ChipSet>
    )
  ).toMatchSnapshot();
});

it("handles deleting an inpput chip", () => {
  class InputChips extends React.Component {
    render() {
      return (
        <ChipSet input>
          <Chip>
            <ChipLeadingIcon>face</ChipLeadingIcon>
            <ChipText>Chip One</ChipText>
            <ChipDeleteIcon onClick={this.props.onDelete} />
          </Chip>
        </ChipSet>
      );
    }
  }

  const handleDelete = jest.fn();
  const component = TestUtils.renderIntoDocument(
    <InputChips onDelete={handleDelete} />
  );
  // Find the delete button and click it
  const icon = TestUtils.findRenderedDOMComponentWithClass(
    component,
    "mdc-chip__icon--trailing"
  );
  TestUtils.Simulate.click(icon);
  expect(handleDelete).toHaveBeenCalled();
});
