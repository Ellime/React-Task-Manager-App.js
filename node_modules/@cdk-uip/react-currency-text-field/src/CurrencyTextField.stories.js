import React from "react";
import CurrencyTextField from "./CurrencyTextField";
import { storiesOf } from "@storybook/react";
import { action } from "@storybook/addon-actions";
import { withKnobs, boolean, text, number } from "@storybook/addon-knobs";
import { IntlProvider } from "react-intl";

storiesOf("currency-text-field", module)
  .addDecorator(withKnobs)
  .add("props", () => {
    class Wrapper extends React.Component {
      state = { value: this.props.initialValue };

      render() {
        return (
          <IntlProvider locale="en">
            <CurrencyTextField
              currency={text("currency", "gbp")}
              value={this.state.value}
              onChange={(e, value) => {
                action()(e, value);
                this.setState({ value });
              }}
              label={text("label", "Currency")}
              autoSelect={boolean("autoSelect", true)}
              box={boolean("box", false)}
              fullWidth={boolean("fullWidth", false)}
            />
          </IntlProvider>
        );
      }
    }

    return <Wrapper initialValue={number("initial value", 0)} />;
  })
  .add("update prop value", () => {
    class Wrapper extends React.Component {
      state = { value: 0 };

      componentDidMount() {
        this.setState({ value: 123.45 });
      }

      render() {
        return (
          <IntlProvider locale="en">
            <CurrencyTextField
              currency="usd"
              value={this.state.value}
              onChange={(e, value) => {
                action()(e, value);
                this.setState({ value });
              }}
              label="Currency"
              autoSelect
              box
            />
          </IntlProvider>
        );
      }
    }
    return <Wrapper />;
  })
  .add("update prop value with three decimal digits", () => {
    class Wrapper extends React.Component {
      state = { value: 3 };

      componentDidMount() {
        this.setState({ value: 123.456 });
      }

      render() {
        return (
          <IntlProvider locale="en">
            <CurrencyTextField
              currency="usd"
              value={this.state.value}
              onChange={(e, value) => {
                action()(e, value);
                this.setState({ value });
              }}
              label="Currency"
              decimalDigits={3}
              autoSelect
              box
            />
          </IntlProvider>
        );
      }
    }
    return <Wrapper />;
  })
  .add("update prop value with zero decimal digits", () => {
    class Wrapper extends React.Component {
      state = { value: 0 };

      componentDidMount() {
        this.setState({ value: 123 });
      }

      render() {
        return (
          <IntlProvider locale="en">
            <CurrencyTextField
              currency="usd"
              value={this.state.value}
              onChange={(e, value) => {
                action()(e, value);
                this.setState({ value });
              }}
              label="Currency"
              decimalDigits={0}
              autoSelect
              box
            />
          </IntlProvider>
        );
      }
    }
    return <Wrapper />;
  });
