import React from "react";
import { Menu, MenuAnchor, MenuItem, MenuDivider } from ".";
import { Button } from "@cdk-uip/react-button";
import { storiesOf } from "@storybook/react";
import { action } from "@storybook/addon-actions";
import { withKnobs, select, boolean } from "@storybook/addon-knobs";
import { Icon } from "@cdk-uip/react-icon";

storiesOf("menu", module)
  .addDecorator(withKnobs)
  .add("controlled", () => {
    class Wrapper extends React.Component {
      state = {
        open: false,
        selected: undefined
      };

      render() {
        const anchorPosition = select(
          "Anchor position",
          ["top-left", "top-right", "bottom-right", "bottom-left"],
          "top-left"
        );

        let position = {};

        switch (anchorPosition) {
          default:
          case "top-left":
            position = { top: "0px", left: "0px" };
            break;
          case "top-right":
            position = { top: "0px", right: "0px" };
            break;
          case "bottom-right":
            position = { bottom: "0px", right: "0px" };
            break;
          case "bottom-left":
            position = { bottom: "0px", left: "0px" };
        }

        const icons = boolean("icons", false);

        return (
          <div>
            <div
              style={{
                backgroundColor: "#f5f5f5",
                height: 200,
                width: "100%",
                position: "relative"
              }}
            >
              <MenuAnchor style={{ position: "absolute", ...position }}>
                <Button
                  raised
                  primary
                  onClick={() => this.setState({ open: true })}
                >
                  Open menu
                </Button>

                <Menu
                  open={this.state.open}
                  onCancel={() => {
                    action()("onCancel");
                    this.setState({ open: false });
                  }}
                  onSelected={selected => {
                    action()("onSelected");
                    this.setState({ selected, open: false });
                  }}
                  anchorCorner={select(
                    "anchorCorner",
                    ["top-start", "top-end", "bottom-start", "bottom-end"],
                    "top-start"
                  )}
                  icons={icons}
                >
                  <MenuItem icon={icons && <Icon>done</Icon>}>Item 1</MenuItem>
                  <MenuItem>Item 2</MenuItem>
                  <MenuDivider />
                  <MenuItem icon={icons && <Icon>check_circle</Icon>}>
                    Item 3
                  </MenuItem>
                  <MenuItem disabled>Item 4 is disabled</MenuItem>
                </Menu>
              </MenuAnchor>
            </div>
            {this.state.selected !== undefined && (
              <p>Selected menu index: {this.state.selected}</p>
            )}
          </div>
        );
      }
    }
    return <Wrapper />;
  });
