import React from "react";
import ReactDOM from "react-dom";
import TestUtils from "react-dom/test-utils";
import { TemporarySnackbar } from ".";

jest.useFakeTimers();

it("handles the onClose prop", () => {
  const handleClose = jest.fn();
  TestUtils.renderIntoDocument(
    <TemporarySnackbar
      show
      message="Hello, world!"
      actionText="Action"
      onClose={handleClose}
    />
  );
  jest.runAllTimers();
  expect(handleClose).toHaveBeenCalled();
});

it("handles the onAction prop", () => {
  const handleAction = jest.fn();
  const component = TestUtils.renderIntoDocument(
    <TemporarySnackbar
      show
      message="Hello, world!"
      actionText="Action"
      onAction={handleAction}
    />
  );
  const button = TestUtils.findRenderedDOMComponentWithTag(component, "button");
  TestUtils.Simulate.click(button);
  expect(handleAction).toHaveBeenCalled();
});

it("mounts, updates and unmounts", () => {
  const div = document.createElement("div");
  ReactDOM.render(
    <TemporarySnackbar
      show={false}
      message="Hello, world!"
      actionText="Action"
    />,
    div
  );
  ReactDOM.render(
    <TemporarySnackbar show message="Hello, world!" actionText="Action" />,
    div
  );
  ReactDOM.unmountComponentAtNode(div);
});
