import React from "react";
import TestUtils from "react-dom/test-utils";
import IntlProvider from "./index";
import { params } from "./IntlProvider";
import { FormattedMessage } from "react-intl";
import en from "react-intl/locale-data/en";

describe("params", () => {
  it("splits a locale", () => {
    expect(params("en-GB")).toEqual({
      primary: "en",
      region: "GB"
    });
  });

  it("uses the correct case", () => {
    expect(params("EN-gb")).toEqual({
      primary: "en",
      region: "GB"
    });
  });

  it("handles a missing region", () => {
    expect(params("en")).toEqual({
      primary: "en",
      region: undefined
    });
  });
});

describe("IntlProvider", () => {
  const loadLocaleData = () => Promise.resolve(en);

  const loadMessages = () =>
    Promise.resolve({
      xyz: "Message"
    });

  it("renders without crashing", () => {
    TestUtils.renderIntoDocument(
      <IntlProvider
        loadLocaleData={loadLocaleData}
        loadMessages={loadMessages}
        locale="en-GB"
        language="en"
      >
        <FormattedMessage id="xyz" />
      </IntlProvider>
    );
  });
});
